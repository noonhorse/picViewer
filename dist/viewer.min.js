!function(){function t(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function e(t,e){return t.x*e.x+t.y*e.y}function i(i,s){var n=t(i)*t(s);if(0===n)return 0;var h=e(i,s)/n;return h>1&&(h=1),Math.acos(h)}function s(t,e){return t.x*e.y-e.x*t.y}function n(t,e){var n=i(t,e);return s(t,e)>0&&(n*=-1),180*n/Math.PI}function h(t,e){var i=new o(t);return i.add(e),i}var o=function(t){this.handlers=[],this.el=t};o.prototype.add=function(t){this.handlers.push(t)},o.prototype.del=function(t){t||(this.handlers=[]);for(var e=this.handlers.length;e>=0;e--)this.handlers[e]===t&&this.handlers.splice(e,1)},o.prototype.dispatch=function(){for(var t=0,e=this.handlers.length;t<e;t++){var i=this.handlers[t];"function"==typeof i&&i.apply(this.el,arguments)}};var a=function(t,e){this.element="string"==typeof t?document.querySelector(t):t,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this),this.cancel=this.cancel.bind(this),this.element.addEventListener("touchstart",this.start,!1),this.element.addEventListener("touchmove",this.move,!1),this.element.addEventListener("touchend",this.end,!1),this.element.addEventListener("touchcancel",this.cancel,!1),this.preV={x:null,y:null},this.pinchStartLen=null,this.zoom=1,this.isDoubleTap=!1;var i=function(){};this.rotate=h(this.element,e.rotate||i),this.touchStart=h(this.element,e.touchStart||i),this.multipointStart=h(this.element,e.multipointStart||i),this.multipointEnd=h(this.element,e.multipointEnd||i),this.pinch=h(this.element,e.pinch||i),this.swipe=h(this.element,e.swipe||i),this.tap=h(this.element,e.tap||i),this.doubleTap=h(this.element,e.doubleTap||i),this.longTap=h(this.element,e.longTap||i),this.singleTap=h(this.element,e.singleTap||i),this.pressMove=h(this.element,e.pressMove||i),this.touchMove=h(this.element,e.touchMove||i),this.touchEnd=h(this.element,e.touchEnd||i),this.touchCancel=h(this.element,e.touchCancel||i),this.delta=null,this.last=null,this.now=null,this.tapTimeout=null,this.singleTapTimeout=null,this.longTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null}};a.prototype={start:function(e){if(e.touches){this.now=Date.now(),this.x1=e.touches[0].pageX,this.y1=e.touches[0].pageY,this.delta=this.now-(this.last||this.now),this.touchStart.dispatch(e),null!==this.preTapPosition.x&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;var i=this.preV;if(e.touches.length>1){this._cancelLongTap(),this._cancelSingleTap();var s={x:e.touches[1].pageX-this.x1,y:e.touches[1].pageY-this.y1};i.x=s.x,i.y=s.y,this.pinchStartLen=t(i),this.multipointStart.dispatch(e)}this.longTapTimeout=setTimeout(function(){this.longTap.dispatch(e)}.bind(this),750)}},move:function(e){if(e.touches){var i=this.preV,s=e.touches.length,h=e.touches[0].pageX,o=e.touches[0].pageY;if(this.isDoubleTap=!1,s>1){var a={x:e.touches[1].pageX-h,y:e.touches[1].pageY-o};null!==i.x&&(this.pinchStartLen>0&&(e.zoom=t(a)/this.pinchStartLen,this.pinch.dispatch(e)),e.angle=n(a,i),this.rotate.dispatch(e)),i.x=a.x,i.y=a.y}else null!==this.x2?(e.deltaX=h-this.x2,e.deltaY=o-this.y2):(e.deltaX=0,e.deltaY=0),this.pressMove.dispatch(e);this.touchMove.dispatch(e),this._cancelLongTap(),this.x2=h,this.y2=o,s>1&&e.preventDefault()}},end:function(t){if(t.changedTouches){this._cancelLongTap();var e=this;t.touches.length<2&&this.multipointEnd.dispatch(t),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(t.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout(function(){e.swipe.dispatch(t)},0)):(this.tapTimeout=setTimeout(function(){e.tap.dispatch(t),e.isDoubleTap&&(e.doubleTap.dispatch(t),clearTimeout(e.singleTapTimeout),e.isDoubleTap=!1)},0),e.isDoubleTap||(e.singleTapTimeout=setTimeout(function(){e.singleTap.dispatch(t)},250))),this.touchEnd.dispatch(t),this.preV.x=0,this.preV.y=0,this.zoom=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null}},cancel:function(t){clearTimeout(this.singleTapTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.longTapTimeout),clearTimeout(this.swipeTimeout),this.touchCancel.dispatch(t)},_cancelLongTap:function(){clearTimeout(this.longTapTimeout)},_cancelSingleTap:function(){clearTimeout(this.singleTapTimeout)},_swipeDirection:function(t,e,i,s){return Math.abs(t-e)>=Math.abs(i-s)?t-e>0?"Left":"Right":i-s>0?"Up":"Down"},on:function(t,e){this[t]&&this[t].add(e)},off:function(t,e){this[t]&&this[t].del(e)},destroy:function(){return this.singleTapTimeout&&clearTimeout(this.singleTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.swipeTimeout&&clearTimeout(this.swipeTimeout),this.element.removeEventListener("touchstart",this.start),this.element.removeEventListener("touchmove",this.move),this.element.removeEventListener("touchend",this.end),this.element.removeEventListener("touchcancel",this.cancel),this.rotate.del(),this.touchStart.del(),this.multipointStart.del(),this.multipointEnd.del(),this.pinch.del(),this.swipe.del(),this.tap.del(),this.doubleTap.del(),this.longTap.del(),this.singleTap.del(),this.pressMove.del(),this.touchMove.del(),this.touchEnd.del(),this.touchCancel.del(),this.preV=this.pinchStartLen=this.zoom=this.isDoubleTap=this.delta=this.last=this.now=this.tapTimeout=this.singleTapTimeout=this.longTapTimeout=this.swipeTimeout=this.x1=this.x2=this.y1=this.y2=this.preTapPosition=this.rotate=this.touchStart=this.multipointStart=this.multipointEnd=this.pinch=this.swipe=this.tap=this.doubleTap=this.longTap=this.singleTap=this.pressMove=this.touchMove=this.touchEnd=this.touchCancel=null,null}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=a:window.AlloyFinger=a}(),function(){function t(t,i,s){for(var n=0,h=i.length;n<h;n++)e(t,i[n],s)}function e(t,e,i){Object.defineProperty(t,e,{get:function(){return this["__"+e]},set:function(t){t!==this["__"+e]&&(this["__"+e]=t,i())}})}var i=function(t,e,i,s,n,h,o,a,l,r,c,u,p,d,m,g){this.elements=window.Float32Array?new Float32Array(16):[];var f=this.elements;f[0]=void 0!==t?t:1,f[4]=e||0,f[8]=i||0,f[12]=s||0,f[1]=n||0,f[5]=void 0!==h?h:1,f[9]=o||0,f[13]=a||0,f[2]=l||0,f[6]=r||0,f[10]=void 0!==c?c:1,f[14]=u||0,f[3]=p||0,f[7]=d||0,f[11]=m||0,f[15]=void 0!==g?g:1};i.DEG_TO_RAD=Math.PI/180,i.prototype={set:function(t,e,i,s,n,h,o,a,l,r,c,u,p,d,m,g){var f=this.elements;return f[0]=t,f[4]=e,f[8]=i,f[12]=s,f[1]=n,f[5]=h,f[9]=o,f[13]=a,f[2]=l,f[6]=r,f[10]=c,f[14]=u,f[3]=p,f[7]=d,f[11]=m,f[15]=g,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},multiplyMatrices:function(t,e){var i=t.elements,s=this.elements,n=i[0],h=i[4],o=i[8],a=i[12],l=i[1],r=i[5],c=i[9],u=i[13],p=i[2],d=i[6],m=i[10],g=i[14],f=i[3],y=i[7],T=i[11],v=i[15],w=e[0],b=e[1],x=e[2],M=e[3],_=e[4],X=e[5],D=e[6],E=e[7],S=e[8],k=e[9],Y=e[10],A=e[11],L=e[12],I=e[13],Z=e[14],O=e[15];return s[0]=n*w+h*_+o*S+a*L,s[4]=n*b+h*X+o*k+a*I,s[8]=n*x+h*D+o*Y+a*Z,s[12]=n*M+h*E+o*A+a*O,s[1]=l*w+r*_+c*S+u*L,s[5]=l*b+r*X+c*k+u*I,s[9]=l*x+r*D+c*Y+u*Z,s[13]=l*M+r*E+c*A+u*O,s[2]=p*w+d*_+m*S+g*L,s[6]=p*b+d*X+m*k+g*I,s[10]=p*x+d*D+m*Y+g*Z,s[14]=p*M+d*E+m*A+g*O,s[3]=f*w+y*_+T*S+v*L,s[7]=f*b+y*X+T*k+v*I,s[11]=f*x+y*D+T*Y+v*Z,s[15]=f*M+y*E+T*A+v*O,this},_rounded:function(t,e){return e=Math.pow(10,e||15),Math.round(t*e)/e},appendTransform:function(t,e,s,n,h,o,a,l,r,c,u,p,d,m){var g=a*i.DEG_TO_RAD,f=this._rounded(Math.cos(g)),y=this._rounded(Math.sin(g)),T=l*i.DEG_TO_RAD,v=this._rounded(Math.cos(T)),w=this._rounded(Math.sin(T)),b=r*i.DEG_TO_RAD,x=this._rounded(Math.cos(-1*b)),M=this._rounded(Math.sin(-1*b));return this.multiplyMatrices(this,[1,0,0,t,0,f,y,e,0,-y,f,s,0,0,0,1]),this.multiplyMatrices(this,[v,0,w,0,0,1,0,0,-w,0,v,0,0,0,0,1]),this.multiplyMatrices(this,[x*n,M*h,0,0,-M*n,x*h,0,0,0,0,1*o,0,0,0,0,1]),(c||u)&&this.multiplyMatrices(this,[this._rounded(Math.cos(c*i.DEG_TO_RAD)),this._rounded(Math.sin(c*i.DEG_TO_RAD)),0,0,-1*this._rounded(Math.sin(u*i.DEG_TO_RAD)),this._rounded(Math.cos(u*i.DEG_TO_RAD)),0,0,0,0,1,0,0,0,0,1]),(p||d||m)&&(this.elements[12]-=p*this.elements[0]+d*this.elements[4]+m*this.elements[8],this.elements[13]-=p*this.elements[1]+d*this.elements[5]+m*this.elements[9],this.elements[14]-=p*this.elements[2]+d*this.elements[6]+m*this.elements[10]),this}};var s=function(e){t(e,["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","rotateX","rotateY","rotateZ","skewX","skewY","originX","originY","originZ"],function(){var t=e.matrix3D.identity().appendTransform(e.translateX,e.translateY,e.translateZ,e.scaleX,e.scaleY,e.scaleZ,e.rotateX,e.rotateY,e.rotateZ,e.skewX,e.skewY,e.originX,e.originY,e.originZ);e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform="perspective("+e.perspective+"px) matrix3d("+Array.prototype.slice.call(t.elements).join(",")+")"}),t(e,["perspective"],function(){e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform="perspective("+e.perspective+"px) matrix3d("+Array.prototype.slice.call(e.matrix3D.elements).join(",")+")"}),e.matrix3D=new i,e.perspective=500,e.scaleX=e.scaleY=e.scaleZ=1,e.translateX=e.translateY=e.translateZ=e.rotateX=e.rotateY=e.rotateZ=e.skewX=e.skewY=e.originX=e.originY=e.originZ=0};"undefined"!=typeof module&&"object"==typeof exports?module.exports=s:window.Transform=s}(),function(){Array.prototype.equals||(Array.prototype.equals=function(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var e=0,i=this.length;e<i;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].equals(t[e]))return!1}else if(this[e]!=t[e])return!1;return!0});var t=function(t){var e=t||{};this.initScale=1,this.Mask=document.getElementById("imgview_h5"),this.screenWidth=window.innerWidth||window.screen.availWidth,this.screenHeight=window.innerHeight||window.screen.availHeight,this.imagelist=e.list||[],this.currentIndex=e.index||0,this.list=e.imgsNode||"",this.ob=null,this.focused=null,this.gap_item=e.gap||30,this.pagetype=e.type||"string",this.render()};t.prototype={render:function(){var t=this.imagelist,e=t.length;if(e<1)return!1;if(!this.Mask){var i=document.createElement("div");i.id="imgview_h5",document.body.appendChild(i),this.Mask=document.getElementById("imgview_h5")}for(var s='<ul class="imagelist">',n=0;n<e;n++)s+='<li class="imagelist-item" style="margin-right:'+this.gap_item+'px;"><img src="'+t[n]+'" class="imagelist-item-img IV_imgview'+(n+1)+'" alt=""/></li>';if(s+="</ul>",e>1)if("number"==this.pagetype)s+='<div className="page">'+(this.currentIndex+1)+" / "+e+"</div>";else{s+='<ul class="pagelist">';for(var h=0;h<e;h++)s+='<li class="'+(h==this.currentIndex?"on":"")+'"></li>';s+="</ul>"}this.Mask.innerHTML=s},showImgs:function(t,e,i){if("string"==typeof t&&(t=[t]),!this.imagelist.equals(t)){this.imagelist=t,this.arrLength=t.length,this.render(),this.list=this.Mask.querySelector(".imagelist"),console.log("Transform(this.list);"),Transform(this.list),console.log("Alloy init");var s=this;new AlloyFinger(this.Mask,{singleTap:function(){document.getElementById("imgview_h5").style.display="none"},pressMove:function(t){var e=s.currentIndex;s.endAnimation(),s.focused||(0===e&&t.deltaX>0||e===s.imagelist.length-1&&t.deltaX<0?s.list.translateX+=t.deltaX/3:s.list.translateX+=t.deltaX),t.preventDefault()},swipe:function(t){var e=t.direction,i=s.currentIndex;if(s.focused)return!1;switch(e){case"Left":i<s.arrLength-1&&++i&&s.bindStyle(i);break;case"Right":i>0&&i--&&s.bindStyle(i)}s.changeIndex(i)},touchStart:function(){s.focused=!0},touchEnd:function(t){s.focused=!1}})}"string"==typeof e&&(e=this.imagelist.indexOf(e),console.log("pic of index",e)),this.currentIndex=e||0,this.changeIndex(e),i&&i()},bindStyle:function(t){if(this.ob&&this.restore(),"none"==this.Mask.style.display&&(this.Mask.style.display="block"),this.ob=this.list.querySelector(".IV_imgview"+(t+1)),this.ob&&!this.ob.scaleX){var e=this;Transform(this.ob),this.imgloaded(this.ob),new AlloyFinger(this.ob,{pressMove:function(t){var i=t.deltaX,s=t.deltaY,n=e.ob.scaleX,h=e.ob.width;e.ob.scaleX<=1||t.touches.length>1||(e.ob&&e.checkBoundary(i,s)?(!isLongPic&&(e.ob.translateX+=i),e.ob.translateY+=s,isLongPic&&n*h===e.screenWidth?e.focused=!1:e.focused=!0):e.focused=!1)}})}if(this.Mask.querySelector(".pagelist"))for(var i=this.Mask.querySelectorAll(".pagelist li"),s=0,n=i.length;s<n;s++)s===t?i[s].classList.add("on"):i[s].classList.remove("on")},close:function(){this.divMask.style.display="none"},show:function(){this.Mask.style.display="block"},changeIndex:function(t,e=!0){e&&(this.list.style.webkitTransition="300ms ease"),this.list.translateX=-t*(this.screenWidth+this.gap_item),t>=0&&t<this.imagelist.length&&(this.currentIndex=t),this.bindStyle(t)},setScale:function(t){this.ob.style.webkitTransition="300ms ease-in-out",this.ob.scaleX=this.ob.scaleY=t},restore:function(t=!0){this.ob.translateX=this.ob.translateY=0,!!t&&(this.ob.rotateZ=0),this.ob.scaleX=this.ob.scaleY=1,this.ob.originX=this.ob.originY=0},endAnimation:function(){this.list.style.webkitTransition="0",this.ob&&this.ob.style&&(this.ob.style.webkitTransition="0")},imgloaded:function(t){var e=t,i=e.naturalHeight,s=e.naturalWidth,n=i/s,h=window.innerHeight||window.screen.availHeight,o=window.innerWidth||window.screen.availWidth,a=h/o,l={};n>=3.5&&e.setAttribute("long",!0),n>a?(l.height=h+"px",l.width=s*h/i+"px",l.left=o/2-s*h/i/2+"px"):n<a?(l.width=o+"px",l.height=i*o/s+"px",l.top=h/2-i*o/s/2+"px"):(l.width=o,l.height=h),e.setAttribute("style",`width:${l.width}; height:${l.height}; left:${l.left}; top:${l.top};`),e.setAttribute("rate",1/n)},checkBoundary:function(t=0,e=0){var{scaleX:i,translateX:s,translateY:n,originX:h,originY:o,width:a,height:l}=this.ob,r=this.ob.getAttribute("rate");if(1!==i||i!==r){var c=-(i-1)*(a/2-h)+h,u=(i-1)*(l/2+o)+o,p=-(i-1)*(l/2-o)+o;if(s+t<=(i-1)*(a/2+h)+h&&s+t>=c&&n+e<=u&&n+e>=p)return!0}return!1}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=t:window.ImageView=t}();